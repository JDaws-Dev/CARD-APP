{"id":"CD-2i4","title":"Profile switcher for families","description":"## Overview\nAdd a profile switcher to the app header so families with multiple child profiles can easily switch between them.\n\n## Background\nFrom PRD: \"Multiple child profiles: Support 2-4 child profiles per family subscription\"\nCurrently there's no UI for switching between child profiles. Parents and kids need to switch profiles to view/manage different children's collections.\n\n## Deliverables\n- Profile switcher dropdown in the header\n- Show current active profile with avatar\n- Dropdown lists all available profiles in the family\n- Clicking a profile switches to that profile\n- Visual indicator of which profile is currently selected","acceptance_criteria":"## Acceptance Criteria\n\n- [x] Profile switcher component exists in header for authenticated users - VERIFIED: Created ProfileSwitcher.tsx in src/components/header/, added to AppHeader.tsx for desktop (line 141) and mobile (line 363)\n- [x] Shows current profile name and avatar - VERIFIED: Component shows avatar (or UserCircleIcon fallback) and display name in button (lines 87-100)\n- [x] Dropdown displays all available profiles for the family - VERIFIED: Dropdown maps over availableProfiles from getCurrentUserProfile query (lines 129-172)\n- [x] Clicking a different profile switches to that profile - VERIFIED: handleProfileSelect saves to localStorage and triggers page reload (lines 67-74)\n- [x] Current profile is visually indicated (checkmark or highlight) - VERIFIED: Selected profile has bg-kid-primary/10 highlight and CheckIcon (lines 136-139, 167-168)\n- [x] Works on both desktop and mobile layouts - VERIFIED: Added to both desktop header area and mobile menu\n- [x] Build passes with no TypeScript errors - VERIFIED: npm run build completes successfully (only pre-existing warnings)","notes":"## Implementation Summary\n\n### What was done\n- Created new ProfileSwitcher component at src/components/header/ProfileSwitcher.tsx\n- Integrated ProfileSwitcher into AppHeader.tsx for both desktop and mobile views\n- Component only renders when family has multiple profiles (avoids clutter for single-profile accounts)\n- Uses localStorage to persist selected profile ID across sessions\n- Profile switch triggers page reload to refresh all data with new profile context\n\n### Key decisions\n- Used localStorage for profile persistence instead of Convex state (simpler, works without backend changes)\n- Page reload on profile switch ensures all components get fresh data for the new profile\n- Component hidden when only one profile exists (returns null early)\n- Added eslint-disable comments for img elements (avatar images from user-provided URLs)\n\n### Files modified\n- src/components/header/ProfileSwitcher.tsx (new)\n- src/components/layout/AppHeader.tsx (updated - added import and component instances)\n\n### How it works\n1. Component loads saved profile ID from localStorage on mount\n2. Queries getCurrentUserProfile with the profileId (or empty for default)\n3. Displays current profile name/avatar in header button\n4. Dropdown shows all availableProfiles from the family\n5. On selection, saves new profile ID to localStorage and reloads page","status":"closed","priority":0,"issue_type":"task","owner":"jedaws@gmail.com","created_at":"2026-01-17T16:29:46.614278-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-18T05:04:34.656496-05:00","closed_at":"2026-01-18T05:04:34.656496-05:00","close_reason":"Closed"}
